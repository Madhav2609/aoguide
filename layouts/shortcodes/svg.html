{{- $filename := .Get 0 -}}
{{- $alt := .Get 1 | default "" -}}
{{- $caption := .Get 2 | default "" -}}

{{- $staticPath := printf "static/assets/images/%s" $filename -}}

{{- if fileExists $staticPath }}
  <div style="display: flex; flex-direction: column; align-items: center;">
    <div style="display: flex; justify-content: center;">
      {{- $content := readFile $staticPath -}}
      {{- /* Strip XML prolog and DOCTYPE before embedding */ -}}
      {{- $content = replaceRE `(?s)^\s*(<\?xml[^>]*\?>|<!DOCTYPE[^>]*>)\s*` "" $content -}}
      {{ $content | safeHTML }}
    </div>
    {{- if $caption }}
      <div style="margin-top: 0.5rem; font-style: italic; text-align: center;">{{ $caption }}</div>
    {{- end }}
  </div>
{{- else }}
  <div style="color: red;">⚠️ SVG not found at '{{ $staticPath }}'</div>
{{- end }}